
import {
    HeadingThree,
    Small,
    Tag,
    Tr,
    Td,
  } from "ui/library";

/*

example data payload

 "id": 1712,
    "created": "2021-05-17T21:01:47.586Z",
    "updated": "2021-05-17T21:02:45.587Z",
    "deleted": null,
    "title": "Cross-site scripting in jspdf",
    "found_by": {
      "link": "",
      "name": "Anonymous",
      "email": ""
    },
    "reported_by": {
      "link": "",
      "name": "Anonymous",
      "email": ""
    },
    "module_name": "jspdf",
    "cves": [
      "CVE-2020-7690"
    ],
    "vulnerable_versions": "<2.0.0",
    "patched_versions": ">=2.0.0",
    "overview": "In `jspdf` before version 2.0.0 it is possible to inject JavaScript code via the html method.",
    "recommendation": "Upgrade to version 2.0.0 or later",
    "references": "- [CVE](https://nvd.nist.gov/vuln/detail/CVE-2020-7690)\n- [GitHub Advisory](https://github.com/advisories/GHSA-vh59-v9r5-4mh4)\n",
    "access": "public",
    "severity": "moderate",
    "cwe": "CWE-79",
    "formatted": {
      "created": "May 17th, 2021"
    }

*/
export const VulnerabilityListing = (listingData) => {
  const { module_name, title, severity, formatted, patched_versions } =
    listingData;
  const { created } = formatted;
  return (
    <Tr>
      <Td>
        <Small className="block mb-0.5 font-bold">{module_name}</Small>
        <HeadingThree className="mb-1">{title}</HeadingThree>
        <Tag theme="success" title={`Severity: ${severity}`}>
          {severity}
        </Tag>
      </Td>
      <Td textAlign="center">
        <p className="text-gray-600">{created}</p>
      </Td>
      {patched_versions ?? (
        <Td textAlign="center">
          <Tag theme="info" title="Status: Patched">
            Patched
          </Tag>
        </Td>
      )}
    </Tr>
  );
};
